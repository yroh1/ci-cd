# MULTISTAGE BUILD 
#### Docker container pipelines 

The application we are using as a POC can be downloaded from:  https://github.com/rmotr/flask-api-example

##### Running tests and validation in the applicaiton


We are going to build this application inside a docker container and run:
1. Code analysis
2. Unit tests
3. SonarQube for security check



## Task:

In the current jenkinsfile:
1. Replace to your current Container registry
2. Create a new stage at the end to push the image to DockerHub
2. Fix any stage that failing.


##### Jenkinsfile
bm9kZSB7CiAgIGRlZiBjb21taXRfaWQKICAgc3RhZ2UoJ3N0ZXAgYScpIHsKICAgICBjaGVja291dCBzY20KICAgICBzaCAiZ2l0IHJldi1wYXJzZSAtLXNob3J0IEhFQUQgPiAuZ2l0L2NvbW1pdC1pZCIgICAgICAgICAgICAgICAgICAgICAgICAKICAgICBjb21taXRfaWQgPSByZWFkRmlsZSgnLmdpdC9jb21taXQtaWQnKS50cmltKCkKICAgfQogICBzdGFnZSgnRG9ja2VyQnVpbGQnKSB7CiAgICAgICBkaXIoImRvY2tlci9kYXlfMi8xMmZhY3Rvci9tdWx0aXN0YWdlX2J1aWxkLyIpewogICAgICAgc2ggImRvY2tlciBidWlsZCAtLXRhcmdldCBidWlsZGVyIC10IG1pY2hhYmkvamVua2luc19sYWI6bXVsdGlfc3RhZ2VfYnVpbGRlci0ke2NvbW1pdF9pZH0gLWYgRG9ja2VyZmlsZS1waXBlbGluZXMgLiIKICAgICAgIH0KICAgICB9CiAgIHN0YWdlKCdMaW50aW5nJykgewogICAgICAgZGlyKCJkb2NrZXIvZGF5XzIvMTJmYWN0b3IvbXVsdGlzdGFnZV9idWlsZC8iKXsKICAgICAgIHNoICJkb2NrZXIgYnVpbGQgLS10YXJnZXQgbGludGluZyAtdCBtaWNoYWJpL2plbmtpbnNfbGFiOm11bHRpX3N0YWdlX3Rlc3QtJHtjb21taXRfaWR9IC1mIERvY2tlcmZpbGUtcGlwZWxpbmVzIC4iCiAgICAgICB9CiAgICAgfQogICBzdGFnZSgnUHVzaCB0byBEb2NrZXJIdWInKSB7CiAgICAgICB3aXRoQ3JlZGVudGlhbHMoW3VzZXJuYW1lUGFzc3dvcmQoY3JlZGVudGlhbHNJZDogJ2RvY2tlckh1YkNyZWRlbnRpYWxzJywgcGFzc3dvcmRWYXJpYWJsZTogJ0RPQ0tFUkhVQl9QQVNTJywgdXNlcm5hbWVWYXJpYWJsZTogJ0RPQ0tFUkhVQl9VU0VSJyldKSB7CiAgICAgICAgICAgc2ggImRvY2tlciBsb2dpbiAtdSAke0RPQ0tFUkhVQl9VU0VSfSAtcCAke0RPQ0tFUkhVQl9QQVNTfSIKICAgICAgICAgICBzaCAiZG9ja2VyIHB1c2ggbWljaGFiaS9qZW5raW5zX2xhYjptdWx0aV9zdGFnZV9idWlsZGVyLSR7Y29tbWl0X2lkfSIKICAgICAgICAgICBzaCAiZG9ja2VyIHB1c2ggbWljaGFiaS9qZW5raW5zX2xhYjptdWx0aV9zdGFnZV90ZXN0LSR7Y29tbWl0X2lkfSIKICAgICAgIH0KICAgfSAgIAp9CiAgIAogICAKCgoKCg==
   




